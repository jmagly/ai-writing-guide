# Inception Plan: AIWG Package Distribution

## Phase Overview

**Objective**: Validate the npm distribution approach and create actionable implementation plan.

**Duration**: 1-2 days

**Gate Criteria**: Approved intake documents, confirmed package name availability, CI/CD approach validated.

## Validation Checklist

### Package Name Availability
- [x] `aiwg` - **AVAILABLE** on npmjs.com
- [x] `ai-writing-guide` - **AVAILABLE** (backup option)

### Technical Feasibility
- [x] Node.js 18+ already required
- [x] ESM modules supported
- [x] GitHub Actions supports npm provenance
- [x] Existing CLI structure adaptable

### Risk Assessment

| Risk | Status | Mitigation |
|------|--------|------------|
| Package name taken | **CLEAR** | Name available |
| Package size concerns | To validate | Audit with .npmignore |
| Provenance support | Supported | GitHub Actions OIDC |
| Breaking existing users | Low | Backward compatible design |

## Implementation Workstreams

### WS-1: Package Configuration
- Create/update `package.json` with npm metadata
- Configure `bin` entry for global CLI
- Create `.npmignore` to exclude dev files
- Validate package size < 15MB

### WS-2: CLI Restructure
- Create `bin/aiwg.mjs` entry point
- Refactor command routing for npm context
- Implement channel manager (stable/edge)
- Add `--use-main` / `--use-stable` flags

### WS-3: Update System
- Implement npm registry version check
- Create update prompt UI
- Handle edge mode git operations
- Persist channel config to `~/.aiwg/channel.json`

### WS-4: CI/CD Pipeline
- Create `.github/workflows/npm-publish.yml`
- Configure npm token secret
- Enable provenance attestation
- Test with dry-run publish

### WS-5: Documentation
- Update README with npm install instructions
- Document channel switching
- Update CLAUDE.md installation section
- Create migration guide for install.sh users

## Deliverables

| Deliverable | Description |
|-------------|-------------|
| package.json | npm package configuration |
| bin/aiwg.mjs | CLI entry point |
| src/channel/*.mjs | Channel management |
| src/update/*.mjs | Update checking |
| .github/workflows/npm-publish.yml | CI/CD pipeline |
| Updated README | Installation documentation |

## Approval Request

### Summary

This plan proposes distributing AIWG via npm with the following key decisions:

1. **npm only** for v1.0 (Homebrew/apt future)
2. **CalVer versioning** (YYYY.MM.PATCH)
3. **Full bundle** included in package
4. **Post-install flag** (`--use-main`) for bleeding edge
5. **Auto-update prompt** with user confirmation
6. **Tag-triggered** CI/CD with signed releases

### Files to Review

```
.aiwg/intake/package-distribution/
├── project-intake.md      # Problem statement and requirements
├── solution-profile.md    # Architecture and implementation design
├── option-matrix.md       # Decision rationale
└── inception-plan.md      # This file
```

### Questions for Approval

1. **Package name**: Proceed with `aiwg` as primary name?
2. **CalVer format**: `2024.12.0` acceptable for first release?
3. **Scope**: npm-only for v1.0, defer Homebrew/apt?
4. **Timeline**: Ready to proceed to Elaboration phase?

---

## Next Steps (Post-Approval)

1. **Elaboration Phase**: Detailed technical design
   - Package structure finalization
   - Channel manager detailed design
   - Update flow state machine
   - Test strategy

2. **Construction Phase**: Implementation
   - WS-1 through WS-5 execution
   - Unit and integration tests
   - Dry-run publish validation

3. **Transition Phase**: Release
   - First npm publish
   - Documentation updates
   - Announcement

---

*Generated by AIWG intake-wizard on 2024-12-09*
